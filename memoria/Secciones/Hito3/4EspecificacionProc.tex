\chapterA{Especificación del procesamiento de impresión} 

\begin{lstlisting}

imprime(prog(Blo)):
    imprime(Blo)
    
imprime(bloq(Decs,Instr)):
    print"{"
    nl
    imprime(Decs)
    imprime (Instr)
    print"}"
    nl

imprime(si_decs(LDecs)):
    imprime(Ldecs)
    print "&&"
    nl
    
imprime(no_decs(LDecs)): noop
imprime(muchas_decs(Ldecs, Dec)):
    imprime(ldecs)
    print ";"
    nl
    imprime(Dec)

imprime(una_dec(Dec)):
    imprime(Dec)
    
imprime(muchas_var(lvar, Dec)):
    imprime(lvar)
    print ","
    nl
    imprime(Dec)
    
imprime(una_var(Dec)):
    imprime(Dec)
    nl

imprime(si_inst(lInstr)):
    imprime(linstr)
imprime(no_inst()): noop
imprime(muchas_inst(linstr, instr)):
    imprime(linstr)
    print ";"
    nl
    imprime(instr)
    
imprime(una_inst(intr)):
    imprime(instr)

imprime(dec_simple(Tipo, Id)):
    imprime(Tipo)
    print Id
    nl
    
imprime(tipo_array(Tipo, N)):
    
    imprime(Tipo)
    print "["
    nl
    imprime(N)
    print "]"

imprime(tipo_punt(Tipo2)):
    print "^"
    nl
    imprime(Tipo2)

imprime(tipo_bool()):
    print "<bool>"
    nl
    
imprime(tipo_int()):
    print "<int>"
    nl
    
imprime(tipo_real()):
    print "<real>"
    nl

imprime(tipo_string()):
    print "<string>"
    nl
 
imprime(tipo_ident(Id)):
    print Id
    nl

imprime(Tipo_struct(lvar)):
    print "<struct>"
    nl
    print "{"
    nl
    imprime(lvar)
    print "}"
    nl

imprime(si_pformal(l-par-formal)):
    imprime(l-par-formal)

imprime(no_pformal()):noop

imprime(muchos_pformal(par-formal,l-par-formal)):
    imprime(par-formal)
    print ","
    nl
    imprime(l-par-formal)

imprime(un_pformal(par-formal)):
    imprime(par-formal)

imprime(pformal-ref(Tipo,Id)):
    imprime(Tipo)
    print "&"
    nl
    print Id
    nl

imprime(pformal_noref(Tipo, Id)):
    imprime(Tipo)
    print Id
    nl

imprime(si_preales(l-par-real)):
    imprime(l-par-real)

imprime(no_preales()):noop

imprime(muchas_exp(Exp, l-par-real)):
    imprime(Exp)
    print ","
    nl
    imprime(l-par-real)

imprime(una_exp(Exp)):
    imprime(Exp)
    nl

imprime(inst_eval(Exp)):
    imprime(Exp)

imprime(inst_if(Exp, bloq)):
    print "<if>"
    nl
    imprime(Exp)
    imprime(bloq)

imprime(inst_else(Exp, bloq, bloq)):
    print "<if>"
    nl
    imprime(Exp)
    imprime(bloq)
    print "<else>"
    nl
    imprime(bloq)

imprime(inst_while(Exp, bloq)):
    print "<while>"
    nl
    imprime(Exp)
    imprime(bloq)

imprime(inst_new(Exp)):
    print "<new>"
    nl
    imprime(Exp)


imprime(inst_delete(Exp)):
    print "<delete>"
    nl
    imprime(Exp)
    
imprime(inst_read(Exp)):
    print "<read>"
    nl
    imprime(Exp)

imprime(inst_write(Exp)):
    print "<write>"
    nl
    imprime(Exp)


imprime(inst_call(Id, par-real)):
    print "<call>"
    nl
    print Id
    nl
    imprime(par-real)

imprime(inst_blo(bloq)):
    imprime(bloq)
   
imprime(dec_proc(Id, par-formales, bloq)):
    print "<proc>"
    nl
    print Id
    nl
    imprime(par-formales)
    imprime(bloq)
    
imprime(dec_type(tipo, Id)):
    print "<type>"
    nl
    imprime(tipo)
    print Id
    
    
imprime(nl):
    print "<nl>"
    nl

imprime(exp_true()):
    print "<true>"
    nl

imprime(exp_false()):
    print "<false>"
    nl
        
imprime(exp_null()):
    print "<null>"
    nl
    
imprime(exp_litEnt(N)):
    print N
    nl

imprime(exp_litReal:(R)):
    print R
    nl

imprime(exp_litCad(C)):
    print C
    nl

imprime (EOF()):
    print "<EOF>"

imprime(exp_asig(Opnd0,Opnd1)):
    imprimeExpBin(Opnd0,"=",Opnd1,1,0)
imprime(exp_suma(Opnd0,Opnd1)):
    imprimeExpBin(Opnd0,"+",Opnd1,2,3)
imprime(exp_resta(Opnd0,Opnd1)):
    imprimeExpBin(Opnd0,"-",Opnd1,3,3)
imprime(exp_and(Opnd0,Opnd1)):
    imprimeExpBin(Opnd0,"<and>",Opnd1,4,3)
imprime(exp_or(Opnd0,Opnd1)):
    imprimeExpBin(Opnd0,"<or>",Opnd1,4,4)
imprime(exp_mult(Opnd0,Opnd1)):
    imprimeExpBin(Opnd0,"*",Opnd1,4,5)
imprime(exp_div(Opnd0,Opnd1)):
    imprimeExpBin(Opnd0,“/",Opnd1,4,5)
imprime(exp_mod(Opnd0,Opnd1)):
    imprimeExpBin(Opnd0,“%",Opnd1,4,5)

imprime(exp_men(Opnd0,Opnd1)):
    imprimeExpBin(Opnd0,“<",Opnd1,1,2)
imprime(exp_menIgual(Opnd0,Opnd1)):
    imprimeExpBin(Opnd0,“<=",Opnd1,1,2)
imprime(exp_mayor(Opnd0,Opnd1)):
    imprimeExpBin(Opnd0,“>",Opnd1,1,2)
imprime(exp_mayIgual(Opnd0,Opnd1)):
    imprimeExpBin(Opnd0,“>=",Opnd1,1,2)
imprime(exp_igual(Opnd0,Opnd1)):
    imprimeExpBin(Opnd0,“==",Opnd1,1,2)
imprime(exp_dist(Opnd0,Opnd1)):
    imprimeExpBin(Opnd0,“!=",Opnd1,1,2)

imprime(exp_menos(Opnd0)):
    print “-"
    nl
    imprimeOpnd(Opnd0,5)
    
imprime(exp_not(Opnd0)):
    print “<not>"
    nl
    imprimeOpnd(Opnd0, 5);
 
imprime(exp_index(Opnd0, Opnd1)):
    imprimeOpnd(Opnd0,6)
    print "["
    nl
    imprimeOpnd(Opnd1,0)
    print "]"
    nl
    
imprime(exp_reg(Opnd0)):
    imprimeOpnd(Opnd0,6)
    print "."
    nl
    
imprime(exp_indir(Opnd0)):
    imprimeOpnd(Opnd0,6)
    print "^"
    nl
    
imprimeExpBin(Opnd0,Op,Opnd1,np0,np1):
    imprimeOpnd(Opnd0,np0)
    print " "++Op++" "
    imprimeOpnd(Opnd1,np1)
    
imprimeOpnd(Opnd,MinPrior):
    if prioridad(Opnd) < MinPrior
        print “(“
        nl
    end if
    imprime(Opnd)
    ml
    if prioridad(Opnd) < MinPrior
        print “)“
        l
    end if    


prioridad(exp_suma(_,_)): return 2
prioridad(exp_resta(_,_)): return 2
prioridad(exp_and(_,_)): return 3
prioridad(exp_or(_,_)): return 3
prioridad(exp_mult(_,_)): return 4
prioridad(exp_div(_,_)): return 4
prioridad(exp_mod(_,_)): return 4

prioridad(exp_asig(_,_)): return 0
prioridad(exp_men(_,_)): return 1
prioridad(exp_menIgual(_,_)): return 1
prioridad(exp_mayor(_,_)): return 1
prioridad(exp_mayIgual(_,_)): return 1
prioridad(exp_igual(_,_)): return 1
prioridad(exp_dist(_,_)): return 1


prioridad(exp_menos(_)): return 5
prioridad(exp_not(_)): return 5
prioridad(exp_index(_)): return 6
prioridad(exp_reg(_)): return 6
prioridad(exp_indir(_)): return 6




\end{lstlisting}